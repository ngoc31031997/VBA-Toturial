# ✏️ Hướng Dẫn InputBox trong VBA Excel

Hàm `InputBox` hiển thị hộp thoại để người dùng nhập dữ liệu (chuỗi, số...).

---

## 🛠️ Cú pháp

```vba
InputBox(Prompt, [Title], [Default], [XPos], [YPos], [HelpFile], [Context])
```

---

## 📌 Tham số

### 🔹 `Prompt` *(bắt buộc)*

* Chuỗi hiển thị trong hộp thoại.
* Tối đa \~1024 ký tự.
* **Ví dụ:** `"Nhập tên của bạn:"`

### 🔹 `Title` *(tùy chọn)*

* Tiêu đề hiển thị trên hộp thoại.
* Mặc định: `"Microsoft Excel"`
* **Ví dụ:** `"Thông tin người dùng"`

### 🔹 `Default` *(tùy chọn)*

* Giá trị hiển thị sẵn trong ô nhập.
* **Ví dụ:** `"Nguyễn Văn A"`
* Nếu không có, ô sẽ để trống.

### 🔹 `XPos`, `YPos` *(tùy chọn)*

* Tọa độ hiển thị hộp thoại tính từ góc trên trái màn hình (pixel).
* Mặc định: hệ thống tự can giữa.
* **Ví dụ:** `XPos:=500, YPos:=300`

### 🔹 `HelpFile` & `Context` *(hiếm dùng)*

* `HelpFile`: Đường dẫn tệp trợ giúp (.chm)
* `Context`: ID chủ đề trong tệp trợ giúp

---

## 📤 Giá trị trả về

* Giá trị người dùng nhập (kiểu `String`)
* Nếu nhấn Cancel → trả về chuỗi rỗng `""`

---

## 🔍 Hướng dẫn theo bước

### 🌟 Mục tiêu: Hộp thoại yêu cầu người dùng nhập tên → hiện lời chào.

---

### 🧹 Bước 1: Dùng `Prompt` cơ bản

```vba
Sub Step1_PromptOnly()
    Dim userInput As String
    userInput = InputBox("Nhập tên của bạn:")
End Sub
```

---

### 🧹 Bước 2: Thêm `Title`

```vba
Sub Step2_AddTitle()
    Dim userInput As String
    userInput = InputBox("Nhập tên của bạn:", "Thông tin người dùng")
End Sub
```

---

### 🧹 Bước 3: Thêm `Default`

```vba
Sub Step3_AddDefault()
    Dim userInput As String
    userInput = InputBox("Nhập tên của bạn:", "Thông tin người dùng", "Nguyễn Văn A")
End Sub
```

---

### 🧹 Bước 4: Kiểm tra Cancel

```vba
Sub Step4_CheckCancel()
    Dim userInput As String
    userInput = InputBox("Nhập tên của bạn:", "Thông tin người dùng", "Nguyễn Văn A")

    If userInput = "" Then
        MsgBox "Bạn đã hủy hoặc để trống!", vbExclamation
    Else
        MsgBox "Chào bạn: " & userInput, vbInformation
    End If
End Sub
```

---

### 🧹 Bước 5: Đặt vị trí hiển thị

```vba
Sub Step5_SetPosition()
    Dim userInput As String
    userInput = InputBox("Nhập tên của bạn:", "Thông tin người dùng", "Nguyễn Văn A", 400, 300)

    If userInput = "" Then
        MsgBox "Bạn đã hủy hoặc để trống!", vbExclamation
    Else
        MsgBox "Chào bạn: " & userInput, vbInformation
    End If
End Sub
```

---

### 🧹 Bước 6: Ép kiểu số (nâng cao)

```vba
Sub Step6_EnterNumber()
    Dim ageInput As String
    Dim age As Integer

    ageInput = InputBox("Nhập tuổi của bạn:", "Tuổi", "25")

    If IsNumeric(ageInput) Then
        age = CInt(ageInput)
        MsgBox "Bạn " & age & " tuổi", vbInformation
    Else
        MsgBox "Dữ liệu không hợp lệ!", vbCritical
    End If
End Sub
```

---

## 🔧 `Application.InputBox` (nâng cao)

Cho phep chọn kiểu dữ liệu: số, chuỗi, vùng Excel...

### 🧹 Bước 7: Nhập số thực với kiểm tra kiểu

```vba
Sub Step7_ApplicationInputBox_Number()
    Dim numberInput As Double
    numberInput = Application.InputBox("Nhập số:", "Kiểu Double", , , , , , 1)

    If numberInput <> False Then
        MsgBox "Bạn đã nhập: " & numberInput
    Else
        MsgBox "Bạn đã hủy!"
    End If
End Sub
```

### 🧹 Bước 8: Chọn vùng ô trong Excel

```vba
Sub Step8_ApplicationInputBox_Range()
    Dim selectedRange As Range
    On Error Resume Next
    Set selectedRange = Application.InputBox("Chọn vùng dữ liệu:", "Chọn ô", Type:=8)

    If Not selectedRange Is Nothing Then
        MsgBox "Bạn đã chọn: " & selectedRange.Address
    Else
        MsgBox "Bạn đã hủy hoặc sai định dạng!"
    End If
End Sub
```

---

## ⚠️ Lưu ý

* `InputBox` luôn trả về chuỗi (string)  → cần kiểm tra hoặc ép kiểu.
* Dùng `Application.InputBox` để xác định kiểu: số, vùng Excel...
* Không giới hạn độ dài nhập bằng tham số → xử lý sau khi nhập.
